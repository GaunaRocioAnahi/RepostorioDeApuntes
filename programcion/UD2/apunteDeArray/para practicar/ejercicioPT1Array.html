<script>
    
/* Taller de producción - Examen de práctica */

let numEncargos = 0;
let stockMadera = 0;
let stockAcero = 0;

// 1️⃣ Solicitar datos iniciales con validación
while (numEncargos <= 0) {
    numEncargos = Number(prompt("Número de encargos (entero mayor que 0):"));
}

while (stockMadera <= 0) {
    stockMadera = Number(prompt("Stock de madera (varas, entero >0):"));
}

while (stockAcero <= 0) {
    stockAcero = Number(prompt("Stock de acero (kg, >0):"));
}

// 2️⃣ Catálogo del taller usando arrays
let articulos = ["flecha", "escudo", "espada"];
let consumoMadera = [1, 3, 1];    // madera por unidad
let consumoAcero = [0.05, 1.5, 1.2]; // acero por unidad
let precioUnitario = [2, 30, 25];

// 3️⃣ Arrays para acumular resultados
let unidadesPorArticulo = [0,0,0];
let consumoAcumuladoMadera = 0;
let consumoAcumuladoAcero = 0;
let importeTotal = 0;

let encargoActual = 1;
let registroInterrumpido = 0;

while (encargoActual <= numEncargos && registroInterrumpido == 0) {
    console.log("--- Encargo " + encargoActual + " ---");
    
    let tipoArticulo = "";
    let indiceArticulo = -1;

    // Validar tipo de artículo
    while (indiceArticulo == -1) {
        tipoArticulo = prompt("Tipo de artículo (flecha, escudo, espada):");
        for (let i = 0; i < articulos.length; i++) {
            if (tipoArticulo == articulos[i]) {
                indiceArticulo = i;
            }
        }
    }

    // Solicitar unidades
    let unidades = -1;
    while (unidades < 0) {
        unidades = Number(prompt("Número de unidades (>=0):"));
    }

    // Calcular consumos
    let consumoMaderaEncargo = consumoMadera[indiceArticulo] * unidades;
    let consumoAceroEncargo = consumoAcero[indiceArticulo] * unidades;

    // Comprobar stock
    if (consumoAcumuladoMadera + consumoMaderaEncargo > stockMadera) {
        alert("¡Alerta! Has superado el stock de madera.");
        registroInterrumpido = 1;
    } else if (consumoAcumuladoAcero + consumoAceroEncargo > stockAcero) {
        alert("¡Alerta! Has superado el stock de acero.");
        registroInterrumpido = 1;
    } else {
        // Actualizar acumuladores
        consumoAcumuladoMadera += consumoMaderaEncargo;
        consumoAcumuladoAcero += consumoAceroEncargo;
        unidadesPorArticulo[indiceArticulo] += unidades;
        let importeEncargo = unidades * precioUnitario[indiceArticulo];
        importeTotal += importeEncargo;

        console.log("Artículo: " + tipoArticulo + " | Unidades: " + unidades + " | Importe cobrado: " + importeEncargo);
        console.log("Madera gastada: " + consumoMaderaEncargo + " | Acumulada: " + consumoAcumuladoMadera);
        console.log("Acero gastado: " + consumoAceroEncargo + " | Acumulado: " + consumoAcumuladoAcero);

        encargoActual++;
    }
}

// 4️⃣ Resumen final
console.log("=== RESUMEN FINAL ===");
console.log("Encargos registrados: " + (encargoActual - (registroInterrumpido==1?1:0)) + " de " + numEncargos);
console.log("Unidades → Flecha: " + unidadesPorArticulo[0] + " | Escudo: " + unidadesPorArticulo[1] + " | Espada: " + unidadesPorArticulo[2]);
console.log("Consumo total → Madera: " + consumoAcumuladoMadera + " varas | Acero: " + consumoAcumuladoAcero + " kg");
console.log("Stock restante → Madera: " + (stockMadera - consumoAcumuladoMadera) + " varas | Acero: " + (stockAcero - consumoAcumuladoAcero) + " kg");
console.log("Importe total: " + importeTotal);
if (registroInterrumpido == 1) {
    console.log("Registro interrumpido por superación de stock.");
} else {
    console.log("Registro completado con éxito.");
}


</script>